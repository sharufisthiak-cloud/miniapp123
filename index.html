<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tale Stars App</title>
    <script src="https://telegram.org"></script>
    <style>
        :root {
            --primary: #7289da; --bg: #0f172a; --card: #1e293b;
            --text: #f8fafc; --accent: #38bdf8; --success: #10b981;
        }
        body {
            font-family: sans-serif; background: var(--bg); color: var(--text);
            margin: 0; padding: 0; display: flex; flex-direction: column; align-items: center;
        }
        .header { text-align: center; padding: 20px; background: #1e293b; width: 100%; border-bottom: 2px solid var(--primary); }
        .tabs { display: flex; width: 90%; background: rgba(0,0,0,0.2); padding: 5px; border-radius: 12px; margin: 15px 0; }
        .tab-btn { flex: 1; background: none; border: none; color: #94a3b8; padding: 12px; border-radius: 10px; cursor: pointer; font-weight: bold; }
        .tab-btn.active { background: var(--primary); color: white; }
        .container { display: none; width: 90%; max-width: 400px; text-align: center; }
        .container.active { display: block; }
        .card { background: var(--card); padding: 25px; border-radius: 20px; margin-top: 10px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); }
        .main-action { background: var(--primary); color: white; border: none; padding: 16px; border-radius: 12px; font-weight: bold; width: 100%; margin-top: 20px; font-size: 15px; cursor: pointer; }
        input { width: 100%; padding: 14px; border-radius: 12px; border: 1px solid #334155; background: #0f172a; color: white; box-sizing: border-box; text-align: center; margin-bottom: 10px; }
        .key-box { background: #000; color: var(--success); padding: 15px; border-radius: 10px; margin-top: 15px; font-family: monospace; cursor: pointer; border: 1px dashed var(--success); word-wrap: break-word; }
        .key-item { background: var(--card); padding: 15px; border-radius: 12px; margin-bottom: 10px; text-align: left; border-left: 4px solid var(--accent); }
    </style>
</head>
<body>

<div class="header"><h1>TALE STARS</h1></div>

<div class="tabs">
    <button class="tab-btn active" id="tab-shop-btn">–ú–∞–≥–∞–∑–∏–Ω</button>
    <button class="tab-btn" id="tab-keys-btn">–ú–æ–∏ –∫–ª—é—á–∏</button>
    <button class="tab-btn" id="tab-act-btn">–ê–∫—Ç–∏–≤–∞—Ü–∏—è</button>
</div>

<div id="shop" class="container active">
    <div class="card" id="shop-content">
        <h3>–ü–æ–ª—É—á–∏—Ç—å –ª–∏—Ü–µ–Ω–∑–∏—é</h3>
        <p style="font-size: 14px; color: #94a3b8;">–ù–∞–∂–º–∏, —á—Ç–æ–±—ã —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á Tale Stars (30 –¥–Ω–µ–π).</p>
        <button class="main-action" id="gen-key-btn">–ì–ï–ù–ï–†–ò–†–û–í–ê–¢–¨</button>
        <div id="key-res" class="key-box" style="display:none;"></div>
        <p id="copy-hint" style="display:none; font-size:10px; color:var(--success); margin-top:5px;">–ù–∞–∂–º–∏ –Ω–∞ –∫–ª—é—á, —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å</p>
    </div>
</div>

<div id="my-keys" class="container">
    <div id="keys-list" style="margin-top:10px;">
        <p style="color:#94a3b8;">–ö–ª—é—á–µ–π –µ—â–µ –Ω–µ—Ç</p>
    </div>
</div>

<div id="activate" class="container">
    <div class="card">
        <h3>–í–≤–æ–¥ –∫–ª—é—á–∞</h3>
        <input type="text" id="key-input" placeholder="TS-XXXX-XXXX">
        <button class="main-action" id="activate-btn">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    // –•—Ä–∞–Ω–∏–ª–∏—â–µ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–ª—é—á–µ–π –≤ –ø–∞–º—è—Ç–∏
    let generatedKeysList = [];

    // –ì–ï–ù–ï–†–ê–¶–ò–Ø –ö–õ–Æ–ß–ê
    document.getElementById('gen-key-btn').addEventListener('click', () => {
        const key = "TS-" + Math.random().toString(36).substring(2, 7).toUpperCase() + "-" + Math.random().toString(36).substring(2, 7).toUpperCase();
        
        generatedKeysList.push(key); // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Å–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö
        
        const resBox = document.getElementById('key-res');
        resBox.innerText = key;
        resBox.style.display = 'block';
        document.getElementById('copy-hint').style.display = 'block';
        
        tg.HapticFeedback.impactOccurred('medium');
    });

    // –ö–û–ü–ò–†–û–í–ê–ù–ò–ï –ö–õ–Æ–ß–ê
    document.getElementById('key-res').addEventListener('click', function() {
        const text = this.innerText;
        navigator.clipboard.writeText(text).then(() => {
            tg.showAlert("–ö–ª—é—á —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!");
        });
    });

    // –ê–ö–¢–ò–í–ê–¶–ò–Ø –ö–õ–Æ–ß–ê
    document.getElementById('activate-btn').addEventListener('click', () => {
        const input = document.getElementById('key-input').value.trim();
        
        if (generatedKeysList.includes(input)) {
            tg.HapticFeedback.notificationOccurred('success');
            tg.showAlert("‚úÖ –£—Å–ø–µ—à–Ω–æ! –ß–∏—Ç Tale Stars –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω –Ω–∞ 30 –¥–Ω–µ–π.");
            
            document.getElementById('shop-content').innerHTML = `
                <div style="font-size:40px;">üëë</div>
                <h3 style="color:var(--success)">–ü–û–î–ü–ò–°–ö–ê –ê–ö–¢–ò–í–ù–ê</h3>
                <p>–í–∞—à–∞ –ª–∏—Ü–µ–Ω–∑–∏—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞. –ß–∏—Ç –≥–æ—Ç–æ–≤ –∫ —Ä–∞–±–æ—Ç–µ.</p>
            `;
            showTab('shop');
        } else {
            tg.HapticFeedback.notificationOccurred('error');
            tg.showAlert("‚ùå –û—à–∏–±–∫–∞: –î–∞–Ω–Ω—ã–π –∫–ª—é—á –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ —É–∂–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.");
        }
    });

    // –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö
    function showTab(id) {
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        
        document.getElementById(id).classList.add('active');
        if(id === 'shop') document.getElementById('tab-shop-btn').classList.add('active');
        if(id === 'my-keys') {
            document.getElementById('tab-keys-btn').classList.add('active');
            updateKeysList();
        }
        if(id === 'activate') document.getElementById('tab-act-btn').classList.add('active');
    }

    function updateKeysList() {
        const list = document.getElementById('keys-list');
        if(generatedKeysList.length === 0) return;
        list.innerHTML = generatedKeysList.map(k => `
            <div class="key-item">
                <div style="color:var(--accent); font-weight:bold;">${k}</div>
                <div style="font-size:11px; color:#64748b; margin-top:4px;">–°—Ç–∞—Ç—É—Å: –û–∂–∏–¥–∞–µ—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏</div>
            </div>
        `).join('');
    }

    document.getElementById('tab-shop-btn').addEventListener('click', () => showTab('shop'));
    document.getElementById('tab-keys-btn').addEventListener('click', () => showTab('my-keys'));
    document.getElementById('tab-act-btn').addEventListener('click', () => showTab('activate'));

</script>
</body>
</html>

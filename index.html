<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tale Stars</title>
    <script src="https://telegram.org"></script>
    <style>
        :root {
            --primary: #7289da;
            --bg: #0f172a;
            --card: #1e293b;
            --text: #f8fafc;
            --accent: #38bdf8;
            --success: #10b981;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: var(--bg);
            color: var(--text);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
        }

        .header {
            text-align: center;
            padding: 20px;
            background: #1e293b;
            width: 100%;
            box-shadow: 0 2px 10px rgba(0,0,0,0.3);
        }

        .status-banner {
            background: rgba(16, 185, 129, 0.15);
            border: 1px solid var(--success);
            color: var(--success);
            padding: 12px;
            border-radius: 12px;
            font-size: 13px;
            margin: 15px auto;
            width: 85%;
            display: none;
            text-align: center;
            font-weight: bold;
        }

        .tabs {
            display: flex;
            width: 90%;
            background: rgba(0,0,0,0.2);
            padding: 4px;
            border-radius: 12px;
            margin: 15px 0;
        }

        .tab-btn {
            flex: 1;
            background: none;
            border: none;
            color: #94a3b8;
            padding: 12px;
            border-radius: 10px;
            font-size: 13px;
            font-weight: 600;
            cursor: pointer;
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        .container {
            display: none;
            width: 90%;
            max-width: 400px;
        }

        .container.active { display: block; }

        .card {
            background: var(--card);
            padding: 25px;
            border-radius: 20px;
            text-align: center;
            border: 1px solid rgba(255,255,255,0.05);
        }

        .main-action {
            background: var(--primary);
            color: white;
            border: none;
            padding: 16px;
            border-radius: 12px;
            font-weight: bold;
            width: 100%;
            margin-top: 20px;
            font-size: 15px;
        }

        .key-display {
            background: #000;
            color: var(--success);
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
            font-family: monospace;
            word-break: break-all;
            display: none;
            border: 1px dashed var(--success);
        }

        input {
            width: 100%;
            padding: 14px;
            border-radius: 12px;
            border: 1px solid #334155;
            background: #0f172a;
            color: white;
            box-sizing: border-box;
            text-align: center;
            font-size: 16px;
        }

        .key-item {
            background: var(--card);
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            border-left: 4px solid var(--accent);
        }
    </style>
</head>
<body>

<div class="header">
    <h1 style="margin:0; font-size: 20px; letter-spacing: 2px;">TALE STARS</h1>
</div>

<div id="global-status" class="status-banner">
    ‚úì –°–ò–°–¢–ï–ú–ê –ê–ö–¢–ò–í–ò–†–û–í–ê–ù–ê
</div>

<div class="tabs">
    <button id="btn-shop" class="tab-btn active" onclick="switchTab('shop')">–ú–∞–≥–∞–∑–∏–Ω</button>
    <button id="btn-keys" class="tab-btn" onclick="switchTab('my-keys')">–ö–ª—é—á–∏</button>
    <button id="btn-act" class="tab-btn" onclick="switchTab('activate')">–í–≤–æ–¥</button>
</div>

<!-- SHOP -->
<div id="shop" class="container active">
    <div class="card" id="main-card">
        <div style="font-size: 40px; margin-bottom: 10px;">üí´</div>
        <h3>Tale Stars Free</h3>
        <p style="color: #94a3b8; font-size: 14px;">–ù–∞–∂–º–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –Ω–∏–∂–µ, —á—Ç–æ–±—ã —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å —Å–ª–æ–∂–Ω—ã–π –∫–ª—é—á –Ω–∞ 30 –¥–Ω–µ–π.</p>
        <button class="main-action" onclick="generateKey()">–ü–û–õ–£–ß–ò–¢–¨ –ö–õ–Æ–ß</button>
        <div id="key-result" class="key-display"></div>
    </div>
</div>

<!-- MY KEYS -->
<div id="my-keys" class="container">
    <div id="keys-list">
        <p style="text-align: center; color: #94a3b8;">–£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –∫–ª—é—á–µ–π</p>
    </div>
</div>

<!-- ACTIVATE -->
<div id="activate" class="container">
    <div class="card">
        <h3>–ê–∫—Ç–∏–≤–∞—Ü–∏—è</h3>
        <input type="text" id="keyInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à –∫–ª—é—á">
        <button id="confirm-btn" class="main-action" onclick="activateKey()">–ê–ö–¢–ò–í–ò–†–û–í–ê–¢–¨</button>
    </div>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();
    tg.expand();

    let userKeys = [];

    function switchTab(tabId) {
        // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
        document.querySelectorAll('.container').forEach(c => c.classList.remove('active'));
        // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —É –∫–Ω–æ–ø–æ–∫
        document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
        
        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –Ω—É–∂–Ω—ã–π
        document.getElementById(tabId).classList.add('active');
        // –ü–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫–Ω–æ–ø–∫—É (–∏—â–µ–º –ø–æ ID)
        if(tabId === 'shop') document.getElementById('btn-shop').classList.add('active');
        if(tabId === 'my-keys') {
            document.getElementById('btn-keys').classList.add('active');
            renderKeys();
        }
        if(tabId === 'activate') document.getElementById('btn-act').classList.add('active');
    }

    function generateKey() {
        const part1 = Math.random().toString(36).substring(2, 7).toUpperCase();
        const part2 = Math.random().toString(36).substring(2, 7).toUpperCase();
        const part3 = Math.random().toString(36).substring(2, 7).toUpperCase();
        const fullKey = `TS-${part1}-${part2}-${part3}`;

        userKeys.push({
            code: fullKey,
            date: new Date().toLocaleDateString()
        });

        const res = document.getElementById('key-result');
        res.innerText = fullKey;
        res.style.display = 'block';

        tg.HapticFeedback.impactOccurred('heavy');
    }

    function renderKeys() {
        const list = document.getElementById('keys-list');
        if(userKeys.length === 0) return;

        list.innerHTML = userKeys.map(k => `
            <div class="key-item">
                <div style="font-weight:bold; color:var(--accent);">${k.code}</div>
                <div style="font-size:11px; color:#64748b; margin-top:5px;">–°–æ–∑–¥–∞–Ω: ${k.date} (–Ω–∞ 30 –¥–Ω–µ–π)</div>
            </div>
        `).join('');
    }

    function activateKey() {
        const val = document.getElementById('keyInput').value;
        if(val.length < 5) {
            tg.showAlert("–°–Ω–∞—á–∞–ª–∞ –≤–≤–µ–¥–∏—Ç–µ –∫–ª—é—á!");
            return;
        }

        // –í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
        document.getElementById('global-status').style.display = 'block';
        const btn = document.getElementById('confirm-btn');
        btn.innerText = "–ê–ö–¢–ò–í–ò–†–û–í–ê–ù–û";
        btn.style.background = "var(--success)";
        
        tg.HapticFeedback.notificationOccurred('success');
        tg.showAlert("Tale Stars —É—Å–ø–µ—à–Ω–æ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ü—Ä–∏—è—Ç–Ω–æ–π –∏–≥—Ä—ã.");

        // –°–º–µ–Ω–∞ –≥–ª–∞–≤–Ω–æ–≥–æ —ç–∫—Ä–∞–Ω–∞
        setTimeout(() => {
            document.getElementById('main-card').innerHTML = `
                <div style="font-size: 50px;">üöÄ</div>
                <h2 style="color:var(--success)">–î–æ—Å—Ç—É–ø –æ—Ç–∫—Ä—ã—Ç</h2>
                <p>–í–∞—à–∞ –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω–∞ –≤ —Å–∏—Å—Ç–µ–º–µ Tale Stars.</p>
            `;
            switchTab('shop');
        }, 1000);
    }
</script>
</body>
</html>
